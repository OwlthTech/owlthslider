/*! For license information please see owlthslider.min.js.LICENSE.txt */
(()=>{"use strict";var e={"./admin/css/owlthslider-admin.css":(e,t,o)=>{o.r(t)}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,o),r.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};o.r(s),o("./admin/css/owlthslider-admin.css"),jQuery(document).ready((e=>{function t(){e("#os-slider-table tbody tr").each((function(t){e(this).find("input, textarea").each((function(){const o=e(this).attr("name");if(o){const s=o.replace(/\[\d+\]/,`[${t}]`);e(this).attr("name",s)}const s=e(this).attr("id");if(s&&s.includes("os_slider")){const o=s.replace(/(\d+)/,t);e(this).attr("id",o)}const i=e(this).attr("class");if(i){const o=i.split(" ").map((e=>e.includes("os_slider")?e.replace(/(\d+)/,t):e)).join(" ");e(this).attr("class",o)}}))})),s()}function o(e){tinymce.init({selector:`#${e}`,menubar:!1,branding:!1,quicktags:!0,mediaButtons:!1,quickbars_selection_toolbar:"bold italic | quicklink h2 h3",toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright | bullist numlist | link | removeformat | forecolor backcolor",setup:function(e){e.on("change",(function(){tinymce.triggerSave(),s()}))}})}e("#add-slider-row").on("click",(()=>{let s=e("#os-slider-table tbody tr").length;s++;let i=e("#table-row-template").html();i=i.replace(/index_count/g,s),e("#os-slider-table tbody").append(i),o(`os_slider_caption_${s}`),t()})),e("#os-slider-table tbody tr").each((function(e){o(`os_slider_caption_${e}`)})),e("#os-slider-table").on("click",".remove-row",(function(){confirm("Are you sure you want to remove this row?")&&e("#os-slider-table tbody tr").length>1&&(e(this).closest("tr").remove(),t())})),e("#os-slider-table").on("click",".duplicate-row",(function(){const s=e(this).closest("tr").clone();s.find("input, textarea").val(""),e("#os-slider-table tbody").append(s),t(),o("os_slider_caption_"+(e("#os-slider-table tbody tr").length-1))})),e("#os-slider-table").on("click",".slider-select-image",(function(t){t.preventDefault();const o=e(this);var s=wp.media({title:"Slide Background Image",button:{text:"Set as Slide Background"},multiple:!1}).on("select",(()=>{const e=s.state().get("selection").first().toJSON();console.log("Selected Attachment:",e);const t=o.closest("td").find('input[name*="[background_image]"]');console.log(o.closest("td").find('input[name*="[background_image]"]')),t.val(e.url),console.log("Hidden Input Value After Setting:",t.val()),t.trigger("change"),o.before(`<div class="slider-image-thumbnail"><img src="${e.url}" alt="" /><button type="button" class="button slider-remove-image">&times;</button></div>`),o.closest("td").find('input[name*="[background_image]"]'),o.hide()})).open()})),e("#os-slider-table").on("click",".slider-remove-image",(function(){e(this).closest("td").find('input[name*="background_image"]').val(""),e(this).closest("td").find("button.slider-select-image").show(),e(this).closest(".slider-image-thumbnail").remove()})),e("#os-slider-table tbody").sortable({tolerance:"pointer",revert:"invalid",containment:"parent",animation:200,placeholder:"ui-state-highlight",update(e,o){t()}}),e("#os-slider-table tbody").disableSelection(),e("#post").on("submit",(function(){tinymce.triggerSave()}));const s=function(e){let t;return function(){const o=this,s=arguments;clearTimeout(t),t=setTimeout((function(){t=null,e.apply(o,s)}),1e3)}}((function(){var t=e("#post").serialize();e.ajax({url:os_slider_params.ajax_url,method:"POST",data:{action:"os_auto_save_sliders",os_slider_universal_nonce:os_slider_params.nonce,post_id:os_slider_params.post_id,slider_data:t},success:function(e){e.success?console.log("Slider data saved successfully."):console.error("Error saving slider data:",e.data)},error:function(e,t,o){console.error("AJAX error:",t,o)}})}));e("#post").on("change input","input, select, textarea",s)})),jQuery(document).ready((function(e){e("#os_refresh_reviews").on("click",(function(t){t.preventDefault();var o=e("#os_slider_google_place_id").val();o?confirm("Are you sure you want to refresh the reviews?","owlthslider")&&(e("#os_reviews_table_container").html("<p>Refreshing reviews...</p>"),e.ajax({url:os_slider_params.ajax_url,method:"POST",data:{action:"os_refresh_reviews",os_slider_universal_nonce:os_slider_params.nonce,post_id:os_slider_params.post_id,google_place_id:o},success:function(t){t.success?(e("#os_reviews_table_container").html(t.data),alert("Reviews refreshed successfully.")):(e("#os_reviews_table_container").html(""),alert("Failed to refresh reviews: "+t.data))},error:function(t,o,s){e("#os_reviews_table_container").html(""),console.log(s),alert("AJAX error occurred while refreshing reviews.")}})):alert("Please enter a Google Place ID first.")}))}))})();